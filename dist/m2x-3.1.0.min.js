/**
 * almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(t,e){"function"==typeof define&&define.amd?define(e):t.M2X=e()}(this,function(){var t,e,n;return function(r){function i(t,e){return b.call(t,e)}function o(t,e){var n,r,i,o,s,a,u,c,p,l,d=e&&e.split("/"),f=g.map,h=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=d.concat(t.split("/")),c=0;c<t.length;c+=1)if(l=t[c],"."===l)t.splice(c,1),c-=1;else if(".."===l){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||h)&&f){for(n=t.split("/"),c=n.length;c>0;c-=1){if(r=n.slice(0,c).join("/"),d)for(p=d.length;p>0;p-=1)if(i=f[d.slice(0,p).join("/")],i&&(i=i[r])){o=i,s=c;break}if(o)break;!a&&h&&h[r]&&(a=h[r],u=c)}!o&&a&&(o=a,s=u),o&&(n.splice(0,s,o),t=n.join("/"))}return t}function s(t,e){return function(){return f.apply(r,j.call(arguments,0).concat([t,e]))}}function a(t){return function(e){return o(e,t)}}function u(t){return function(e){m[t]=e}}function c(t){if(i(v,t)){var e=v[t];delete v[t],w[t]=!0,d.apply(r,e)}if(!i(m,t)&&!i(w,t))throw new Error("No "+t);return m[t]}function p(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function l(t){return function(){return g&&g.config&&g.config[t]||{}}}var d,f,h,y,m={},v={},g={},w={},b=Object.prototype.hasOwnProperty,j=[].slice;h=function(t,e){var n,r=p(t),i=r[0];return t=r[1],i&&(i=o(i,e),n=c(i)),i?t=n&&n.normalize?n.normalize(t,a(e)):o(t,e):(t=o(t,e),r=p(t),i=r[0],t=r[1],i&&(n=c(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:n}},y={require:function(t){return s(t)},exports:function(t){var e=m[t];return"undefined"!=typeof e?e:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:l(t)}}},d=function(t,e,n,o){var a,p,l,d,f,g,b=[];if(o=o||t,"function"==typeof n){for(e=!e.length&&n.length?["require","exports","module"]:e,f=0;f<e.length;f+=1)if(d=h(e[f],o),p=d.f,"require"===p)b[f]=y.require(t);else if("exports"===p)b[f]=y.exports(t),g=!0;else if("module"===p)a=b[f]=y.module(t);else if(i(m,p)||i(v,p)||i(w,p))b[f]=c(p);else{if(!d.p)throw new Error(t+" missing "+p);d.p.load(d.n,s(o,!0),u(p),{}),b[f]=m[p]}l=n.apply(m[t],b),t&&(a&&a.exports!==r&&a.exports!==m[t]?m[t]=a.exports:l===r&&g||(m[t]=l))}else t&&(m[t]=n)},t=e=f=function(t,e,n,i,o){return"string"==typeof t?y[t]?y[t](e):c(h(t,e).f):(t.splice||(g=t,e.splice?(t=e,e=n,n=null):t=r),e=e||function(){},"function"==typeof n&&(n=i,i=o),i?d(r,t,e,n):setTimeout(function(){d(r,t,e,n)},4),f)},f.config=function(t){return g=t,g.deps&&f(g.deps,g.callback),f},t._defined=m,n=function(t,e,n){e.splice||(n=e,e=[]),i(m,t)||i(v,t)||(v[t]=[t,e,n])},n.amd={jQuery:!0}}(),n("../dist/lib/almond",function(){}),n("helpers",[],function(){function t(t){var e,n=[].slice.call(arguments,1);for(e=0;e<n.length;e++){var r,i=n[e];for(r in i)t[r]=i[r]}return t}function e(t){for(var e=arguments.length;e--;)t=t.replace(new RegExp("\\{"+e+"\\}","gm"),arguments[e+1]);return t}function n(t){var n=Array.prototype.slice.call(arguments,1).map(function(t){return encodeURIComponent(t)});return e.apply(this,[t].concat(n))}return{extend:t,format:e,url:n}}),n("charts",["helpers"],function(t){var e=function(t){this.client=t};return e.prototype.list=function(t,e){return this.client.get("/charts",t,e)},e.prototype.create=function(t,e,n){return this.client.post("/charts",{params:t},e,n)},e.prototype.view=function(e,n,r){return this.client.get(t.url("/charts/{0}",e),n,r)},e.prototype.update=function(e,n,r,i){return this.client.put(t.url("/charts/{0}",e),{params:n},r,i)},e.prototype.deleteChart=function(e,n,r){return this.client.del(t.url("/charts/{0}",e),n,r)},e.prototype.render=function(e,n,r,i,o){return this.client.get(t.url("/charts/{0}.{1}",e,n),i,o)},e}),n("response",[],function(){var t=function(t){this.raw=t.responseText,"getAllResponseHeaders"in t?this.headers=t.getAllResponseHeaders():this.headers={},this.status=t.status;try{this.json=this.raw?JSON.parse(this.raw):{}}catch(e){this._error=e.toString()}};return t.prototype.error=function(){return!this._error&&this.isError()&&(0===this.status?this._error=new Error("Can't reach the M2X API"):(this._error=new Error(this.json&&this.json.message),this._error.responseJSON=this.json,this._error.statusCode=this.status)),this._error},t.prototype.isError=function(){return 0===this.status?!0:this._error||this.isClientError()||this.isServerError()},t.prototype.isSuccess=function(){return!this.isError()},t.prototype.isClientError=function(){return this.status>=400&&this.status<500},t.prototype.isServerError=function(){return this.status>=500},t}),n("client",["helpers","response"],function(t,e){function n(t){var e,n;for(e in t){var r=t[e];n=n?n+"&":"",n+=encodeURIComponent(e)+"="+encodeURIComponent(r)}return n}function r(t,r,i){var o,s=new XMLHttpRequest,a=n(t.qs),u=a?t.path+"?"+a:t.path;if("withCredentials"in s)s.open(t.verb,u,!0);else{if("undefined"==typeof XDomainRequest)throw"CORS is not supported by this browser.";s=new XDomainRequest,s.open(t.verb,u)}for(var c in t.headers)s.setRequestHeader(c,t.headers[c]);return s.onerror=function(){i&&(o=new e(s),i(o.error()))},s.onload=function(){var t;r&&(t=new e(s),t.isError()?i&&i(t.error()):r(t.json))},s.send(t.body),s}var i="https://api-m2x.att.com/v2",o=function(t,e){var n=function(t,e,n){t[n]=function(t,n,r,i){return this.request(e,t,n,r,i)}};this.apiKey=t,this.apiBase=e||i,this.defaultHeaders={"X-M2X-KEY":this.apiKey};for(var r=["get","post","put","head","options","patch"],o=0;o<r.length;o++)n(this,r[o],r[o]);n(this,"delete","del")};return o.prototype.request=function(e,i,o,s,a){var u,c;if("function"==typeof o&&(a=s,s=o,o={}),c=t.extend(this.defaultHeaders,o.headers||{}),o.params)switch(c["Content-Type"]||(c["Content-Type"]="application/x-www-form-urlencoded"),c["Content-Type"]){case"application/json":u=JSON.stringify(o.params);break;case"application/x-www-form-urlencoded":u=n(o.params);break;default:throw"Unrecognized Content-Type `"+c["Content-Type"]+"`"}return r({path:this.apiBase+i,qs:o.qs,verb:e,headers:c,body:u},s,a)},o}),n("collections",["helpers"],function(t){var e=function(t,e){this.client=t,this.metadata=e};return e.prototype.list=function(t,e,n){return"function"==typeof t&&(e=t,n=e,t={}),this.client.get("/collections",{qs:t||{}},e,n)},e.prototype.create=function(t,e,n){return this.client.post("/collections",{headers:{"Content-Type":"application/json"},params:t},e,n)},e.prototype.update=function(e,n,r,i){return this.client.put(t.url("/collections/{0}",e),{headers:{"Content-Type":"application/json"},params:n},r,i)},e.prototype.view=function(e,n,r){return this.client.get(t.url("/collections/{0}",e),n,r)},e.prototype.metadata=function(e,n,r){return this.client.get(t.url("/collections/{0}/metadata",e),n,r)},e.prototype.updateMetadata=function(e,n,r,i){return this.client.put(t.url("/collections/{0}/metadata",e),{params:n},r,i)},e.prototype.deleteCollection=function(e,n,r){return this.client.del(t.url("/collections/{0}",e),n,r)},e.prototype.readMetadata=function(t,e,n){this.metadata.read("collections",t,e,n)},e.prototype.updateMetadata=function(t,e,n,r){this.metadata.update("collections",t,e,n,r)},e.prototype.readMetadataField=function(t,e,n,r){this.metadata.readField("collections",t,e,n,r)},e.prototype.updateMetadataField=function(t,e,n,r,i){this.metadata.updateField("collections",t,e,n,r,i)},e}),n("commands",["helpers"],function(t){var e=function(t){this.client=t};return e.prototype.list=function(t,e,n){return"function"==typeof t&&(e=t,n=e,t={}),this.client.get("/commands",{qs:t||{}},e,n)},e.prototype.send=function(t,e,n){return this.client.post("/commands",{headers:{"Content-Type":"application/json"},params:t},e,n)},e.prototype.view=function(e,n,r){return this.client.get(t.url("/commands/{0}",e),n,r)},e}),n("devices",["helpers"],function(t){var e=function(t,e,n){this.client=t,this.keysAPI=e,this.metadata=n};return e.prototype.catalog=function(t,e,n){return"function"==typeof t&&(e=t,n=e,t={}),this.client.get("/devices/catalog",{qs:t||{}},e,n)},e.prototype.search=function(t,e,n){return this.client.post("/devices/search",{headers:{"Content-Type":"application/json"},params:t||{}},e,n)},e.prototype.list=function(t,e,n){return this.client.get("/devices",{qs:t||{}},e,n)},e.prototype.tags=function(t,e){return this.client.get("/devices/tags",t,e)},e.prototype.create=function(t,e,n){return this.client.post("/devices",{params:t},e,n)},e.prototype.update=function(e,n,r,i){return this.client.put(t.url("/devices/{0}",e),{headers:{"Content-Type":"application/json"},params:n},r,i)},e.prototype.view=function(e,n,r){return this.client.get(t.url("/devices/{0}",e),n,r)},e.prototype.location=function(e,n,r){return this.client.get(t.url("/devices/{0}/location",e),n,r)},e.prototype.locationHistory=function(e,n,r,i){return"function"==typeof n&&(i=r,r=n,n={}),this.client.get(t.url("/devices/{0}/location/waypoints",e),{qs:n},r,i)},e.prototype.updateLocation=function(e,n,r,i){return this.client.put(t.url("/devices/{0}/location",e),{params:n},r,i)},e.prototype.streams=function(e,n,r){return this.client.get(t.url("/devices/{0}/streams",e),n,r)},e.prototype.updateStream=function(e,n,r,i,o){return this.client.put(t.url("/devices/{0}/streams/{1}",e,n),{params:r},i,o)},e.prototype.setStreamValue=function(e,n,r,i,o){return this.client.put(t.url("/devices/{0}/streams/{1}/value",e,n),{params:r},i,o)},e.prototype.stream=function(e,n,r,i){return this.client.get(t.url("/devices/{0}/streams/{1}",e,n),r,i)},e.prototype.streamValues=function(e,n,r,i,o){var s=t.url("/devices/{0}/streams/{1}/values",e,n);return"function"==typeof r&&(o=i,i=r,r={}),this.client.get(s,{qs:r},i,o)},e.prototype.sampleStreamValues=function(e,n,r,i,o){return this.client.get(t.url("/devices/{0}/streams/{1}/sampling",e,n),{qs:r},i,o)},e.prototype.streamStats=function(e,n,r,i,o){return this.client.get(t.url("/devices/{0}/streams/{1}/stats",e,n),{qs:r},i,o)},e.prototype.values=function(e,n,r,i){var o=t.url("/devices/{0}/values",e);return"function"==typeof n&&(i=r,r=n,n={}),this.client.get(o,{qs:n},r,i)},e.prototype.valuesSearch=function(e,n,r,i){return this.client.post(t.url("/devices/{0}/values/search",e),{headers:{"Content-Type":"application/json"},params:n},r,i)},e.prototype.valuesExport=function(e,n,r,i){return"function"==typeof n&&(i=r,r=n,n={}),this.client.get(t.url("/devices/{0}/values/export.csv",e),{qs:n},r,i)},e.prototype.postValues=function(e,n,r,i,o){return this.client.post(t.url("/devices/{0}/streams/{1}/values",e,n),{params:{values:r}},i,o)},e.prototype.deleteStreamValues=function(e,n,r,i,o){return this.client.del(t.url("/devices/{0}/streams/{1}/values",e,n),{params:r},i,o)},e.prototype.deleteStream=function(e,n,r,i){return this.client.del(t.url("/devices/{0}/streams/{1}",e,n),r,i)},e.prototype.postUpdates=function(e,n,r,i){return this.client.post(t.url("/devices/{0}/updates",e),{headers:{"Content-Type":"application/json"},params:n},r,i)},e.prototype.postUpdate=function(e,n,r,i){return this.client.post(t.url("/devices/{0}/update",e),{headers:{"Content-Type":"application/json"},params:n},r,i)},e.prototype.log=function(e,n,r){return this.client.get(t.url("/devices/{0}/log",e),n,r)},e.prototype.deleteDevice=function(e,n,r){return this.client.del(t.url("/devices/{0}",e),n,r)},e.prototype.keys=function(t,e,n){return this.client.get("/keys",{qs:{device:t}},e,n)},e.prototype.createKey=function(e,n,r,i){this.keysAPI.create(t.extend(n,{device:e}),r,i)},e.prototype.updateKey=function(e,n,r,i,o){this.keysAPI.update(n,t.extend(r,{device:e}),i,o)},e.prototype.readMetadata=function(t,e,n){this.metadata.read("devices",t,e,n)},e.prototype.updateMetadata=function(t,e,n,r){this.metadata.update("devices",t,e,n,r)},e.prototype.readMetadataField=function(t,e,n,r){this.metadata.readField("devices",t,e,n,r)},e.prototype.updateMetadataField=function(t,e,n,r,i){this.metadata.updateField("devices",t,e,n,r,i)},e.prototype.commands=function(e,n,r,i){return"function"==typeof n&&(i=r,r=n,n={}),this.client.get(t.url("/devices/{0}/commands",e),{qs:n},r,i)},e.prototype.command=function(e,n,r,i){return this.client.get(t.url("/devices/{0}/commands/{1}",e,n),r,i)},e.prototype.processCommand=function(e,n,r,i,o){return"function"==typeof r&&(o=i,i=r,r={}),this.client.post(t.url("/devices/{0}/commands/{1}/process",e,n),{headers:{"Content-Type":"application/json"},params:r||{}},i,o)},e.prototype.rejectCommand=function(e,n,r,i,o){return"function"==typeof r&&(o=i,i=r,r={}),this.client.post(t.url("/devices/{0}/commands/{1}/reject",e,n),{headers:{"Content-Type":"application/json"},params:r||{}},i,o)},e}),n("distributions",["helpers"],function(t){var e=function(t,e){this.client=t,this.metadata=e};return e.prototype.list=function(t,e,n){return"function"==typeof t&&(e=t,n=e,t={}),this.client.get("/distributions",{qs:t||{}},e,n)},e.prototype.create=function(t,e,n){return this.client.post("/distributions",{params:t},e,n)},e.prototype.view=function(e,n,r){return this.client.get(t.url("/distributions/{0}",e),n,r)},e.prototype.update=function(e,n,r,i){return this.client.put(t.url("/distributions/{0}",e),{params:n},r,i)},e.prototype.devices=function(e,n,r){return this.client.get(t.url("/distributions/{0}/devices",e),n,r)},e.prototype.addDevice=function(e,n,r,i){return this.client.post(t.url("/distributions/{0}/devices",e),{headers:{"Content-Type":"application/json"},params:{serial:n}},r,i)},e.prototype.deleteDistribution=function(e,n,r){return this.client.del(t.url("/distributions/{0}",e),n,r)},e.prototype.dataStreams=function(e,n,r){return this.client.get(t.url("/distributions/{0}/streams",e),n,r)},e.prototype.updateDataStream=function(e,n,r,i,o){return this.client.put(t.url("/distributions/{0}/streams/{1}",e,n),{headers:{"Content-Type":"application/json"},params:r},i,o)},e.prototype.dataStream=function(e,n,r,i){return this.client.get(t.url("/distributions/{0}/streams/{1}",e,n),r,i)},e.prototype.deleteDataStream=function(e,n,r,i){return this.client.del(t.url("/distributions/{0}/streams/{1}",e,n),r,i)},e.prototype.readMetadata=function(t,e,n){this.metadata.read("distributions",t,e,n)},e.prototype.updateMetadata=function(t,e,n,r){this.metadata.update("distributions",t,e,n,r)},e.prototype.readMetadataField=function(t,e,n,r){this.metadata.readField("distributions",t,e,n,r)},e.prototype.updateMetadataField=function(t,e,n,r,i){this.metadata.updateField("distributions",t,e,n,r,i)},e}),n("jobs",["helpers"],function(t){var e=function(t){this.client=t};return e.prototype.view=function(e,n,r){return this.client.get(t.url("/jobs/{0}",e),n,r)},e}),n("keys",["helpers"],function(t){var e=function(t){this.client=t};return e.prototype.list=function(t,e){return this.client.get("/keys",t,e)},e.prototype.create=function(t,e,n){return this.client.post("/keys",{headers:{"Content-Type":"application/json"},params:t},e,n)},e.prototype.view=function(e,n,r){return this.client.get(t.url("/keys/{0}",e),n,r)},e.prototype.update=function(e,n,r,i){return this.client.put(t.url("/keys/{0}",e),{headers:{"Content-Type":"application/json"},params:n},r,i)},e.prototype.regenerate=function(e,n,r){return this.client.post(t.url("/keys/{0}/regenerate",e),n,r)},e.prototype.del=function(e,n,r){return this.client.del(t.url("/keys/{0}",e),n,r)},e}),n("metadata",["helpers"],function(t){var e=function(t){this.client=t};return e.prototype.read=function(e,n,r,i){return this.client.get(t.url("/{0}/{1}/metadata",e,n),r,i)},e.prototype.update=function(e,n,r,i,o){return this.client.put(t.url("/{0}/{1}/metadata",e,n),{headers:{"Content-Type":"application/json"},params:r},i,o)},e.prototype.readField=function(e,n,r,i,o){return this.client.get(t.url("/{0}/{1}/metadata/{2}",e,n,r),i,o)},e.prototype.updateField=function(e,n,r,i,o,s){return this.client.put(t.url("/{0}/{1}/metadata/{2}",e,n,r),{headers:{"Content-Type":"application/json"},params:{value:i}},o,s)},e}),n("m2x",["charts","client","collections","commands","devices","distributions","jobs","keys","metadata"],function(t,e,n,r,i,o,s,a,u){var c=function(c,p){this.client=new e(c,p),this.metadata=new u(this.client),this.keys=new a(this.client),this.charts=new t(this.client),this.collections=new n(this.client,this.metadata),this.devices=new i(this.client,this.keys,this.metadata),this.distributions=new o(this.client,this.metadata),this.commands=new r(this.client),this.jobs=new s(this.client)};return c.prototype.status=function(t,e){return this.client.get("/status",t,e)},c}),e("m2x")});